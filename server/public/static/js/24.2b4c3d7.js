webpackJsonp([24],{"+KSS":function(t,e,a){"use strict";function s(t){a("ol3I")}Object.defineProperty(e,"__esModule",{value:!0});var r=(a("oAV5"),a("Wby1")),n=a("r4Fr"),i=a("BUx0"),d=a("adbS"),c=a("nCu/"),o=a.n(c),u={data:function(){return{cardData:null,cardInfoShow:!1,token:sessionStorage.getItem("token")?sessionStorage.getItem("token"):localStorage.getItem("token"),list:[],card:{},questCount:0,questTreasure:0,dem:"0",battleCard:[],gc:"0",itemData_:o.a}},components:{menuView:r.a,userTop:i.a,cardInfoDialog:d.a},computed:{shouldQuest:function(){var t=30*(this.questTreasure+1)-this.questCount;return t<0&&(t=0),t},questProgress:function(){var t=30-(30*(this.questTreasure+1)-this.questCount),e=Math.floor(t/30*100);return e>100&&(e=100),e}},filters:{capitalize:function(t){var e=new Date(parseInt(1e3*t));return[e.getFullYear(),e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,e.getDate()<10?"0"+e.getDate():e.getDate()].join("-")+"  "+[e.getHours()<10?"0"+e.getHours():e.getHours(),e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()].join(":")},cardCount:function(t){var e=t;return e-=1,e<0&&(e="无"),e>99&&(e="99+"),e}},mounted:function(){this.$emit("l2dMassage","这里可以通过完成任务获取丰厚奖励哦!"),this.goQuest()},methods:{treasure:function(){var t=this,e={type:"treasure",token:this.token};n.a.quest(e).then(function(e){1===e.data.code?(t.questCount=Number(e.data.questCount),t.questTreasure=Number(e.data.questTreasure),t.$message({message:e.data.msg,type:"success"})):0===e.data.code&&t.$message.error(e.data.msg)})},help:function(){this.$alert("\n        统计类任务只有接受后才会开始计数。<br />\n        放弃任务将会消费150颗星星。<br />\n        任务过期后将会刷新出新的任务来替代过期任务。<br />\n        接受任务后任务会被锁定将不会过期。<br />\n      ",{dangerouslyUseHTMLString:!0,lockScroll:!1})},setDemP:function(t){var e=(Number(this.dem)-Number(t.mark))/t.should[0].number*100;return e=Math.floor(e),e>100&&(e=100),e},setGcP:function(t){var e=(Number(this.gc)-Number(t.mark))/t.should[0].number*100;return e=Math.floor(e),e>100&&(e=100),e},openCardInfo:function(t){this.cardData=t,this.cardData.have=this.card[t.cardId],this.cardInfoShow=!0},updateUserinfo:function(){this.$refs.userTop.getUserInfo()},updateMyCard:function(){this.goQuest()},cardInfoDiaShow:function(t){this.cardInfoShow=t},complete:function(t){var e=this,a={id:t,type:"complete",token:this.token};n.a.quest(a).then(function(t){1===t.data.code?(e.list=t.data.list,e.card=t.data.card,e.gc=t.data.gc,e.dem=t.data.dem,e.questCount=Number(t.data.questCount),e.questTreasure=Number(t.data.questTreasure),e.battleCard=t.data.battleCard,e.$message({message:t.data.msg,type:"success"}),e.updateUserinfo()):0===t.data.code&&e.$message.error(t.data.msg)})},changeQuest:function(t){var e=this;this.$confirm("确定要放弃或更换任务吗？将会花费150颗星星！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",lockScroll:!1,type:"warning"}).then(function(){var a={id:t,type:"change",token:e.token};n.a.quest(a).then(function(t){1===t.data.code?(e.list=t.data.list,e.card=t.data.card,e.gc=t.data.gc,e.dem=t.data.dem,e.questCount=Number(t.data.questCount),e.questTreasure=Number(t.data.questTreasure),e.battleCard=t.data.battleCard,e.$message({message:t.data.msg,type:"success"}),e.updateUserinfo()):0===t.data.code&&e.$message.error(t.data.msg)})}).catch(function(){})},acceptQuest:function(t){var e=this;this.$confirm("确定要接受任务吗？接受后任务将不会过期，但是只能通过放弃任务（消费150星星）来更换任务！另外统计类任务只能通过接受任务才会开始计数！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",lockScroll:!1,type:"warning"}).then(function(){var a={id:t,type:"accept",token:e.token};n.a.quest(a).then(function(t){1===t.data.code?(e.list=t.data.list,e.card=t.data.card,e.gc=t.data.gc,e.dem=t.data.dem,e.questCount=Number(t.data.questCount),e.questTreasure=Number(t.data.questTreasure),e.battleCard=t.data.battleCard,e.$message({message:t.data.msg,type:"success"})):0===t.data.code&&e.$message.error(t.data.msg)})}).catch(function(){})},goQuest:function(){var t=this,e={type:"search",token:this.token};n.a.quest(e).then(function(e){1===e.data.code?(t.list=e.data.list,t.card=e.data.card,t.gc=e.data.gc,t.dem=e.data.dem,t.questCount=Number(e.data.questCount),t.questTreasure=Number(e.data.questTreasure),t.battleCard=e.data.battleCard):0===e.data.code&&t.$message.error(e.data.msg)})}}},l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common_body"},[a("userTop",{ref:"userTop"}),t._v(" "),a("h5",{staticClass:"common_title type_shop"},[t._v("任务")]),t._v(" "),a("div",{staticClass:"tc wm_set_pointer",on:{click:t.help}},[t._v("Tip:统计类任务只有接受后才会开始计数！"),a("i",{staticClass:"el-icon-collection"})]),t._v(" "),a("div",{staticClass:"wm_quest_list_body mt20"},[a("el-row",{attrs:{gutter:20}},[a("transition-group",{attrs:{name:"list-complete",tag:"div"}},t._l(t.list,function(e){return a("el-col",{key:e._id,staticClass:"mb10 list-complete-item",attrs:{span:12,xs:24}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"f15"},[t._v(t._s(e.title))])]),t._v(" "),a("div",{staticClass:"tc mb15"},[a("p",{staticClass:"mb10"},[t._v("奖励:")]),t._v(" "),a("div",t._l(e.gift,function(e,s){return a("div",{key:s,staticClass:"dib ml10 mr10"},["item"===e.type?a("div",[a("div",{staticClass:"mb5"},[a("img",{staticClass:"wm_quest_gift_ico",attrs:{src:"/static/otherImg/item/"+e.itemId+".png"}})]),t._v(" "),a("div",[t._v(t._s(t.itemData_[e.itemId].name)+"×"+t._s(e.number))])]):t._e(),t._v(" "),"star"===e.type?a("div",[a("div",{staticClass:"mb5"},[a("img",{staticClass:"wm_quest_gift_ico",attrs:{src:"/static/otherImg/item/star.png"}})]),t._v(" "),a("div",[t._v("星星×"+t._s(e.number))])]):t._e(),t._v(" "),"battle"===e.type?a("div",[a("div",{staticClass:"mb5"},[a("img",{staticClass:"wm_quest_gift_ico",attrs:{src:"/static/otherImg/item/battle.png"}})]),t._v(" "),a("div",[t._v("对战次数+"+t._s(e.number))])]):t._e()])}),0)]),t._v(" "),a("div",[a("div",{staticClass:"wm_quest_text"},[t._v(t._s(e.text))]),t._v(" "),a("div",{staticClass:"wm_quest_should_list"},["cardToItem"===e.class||"cardToBattle"===e.class?a("div",t._l(e.should,function(e,s){return a("div",{key:s,staticClass:"dib ml5 mr5 tc wm_set_pointer wm_quest_cardlist",on:{click:function(a){return t.openCardInfo(e.card)}}},[-1!==t.battleCard.indexOf(e.card.cardId)?a("div",{staticClass:"wm_quest_battlecard"},[t._v("战")]):t._e(),t._v(" "),a("img",{staticClass:"wm_quest_should_card",attrs:{src:t.$wikimoecard.url+e.card.packageId+"/"+e.card.cardId+".jpg"}}),t._v(" "),a("div",[a("span",{class:{cRed:0===t.card[e.card.cardId],cOrange:t.card[e.card.cardId]-1<e.number&&0!==t.card[e.card.cardId],cGreen1A7:t.card[e.card.cardId]-1>=e.number}},[t._v(t._s(t._f("cardCount")(t.card[e.card.cardId])))]),t._v("/"+t._s(e.number))])])}),0):a("div",[e.lock?a("div",["dataGuessCard"===e.class?a("div",[a("div",{staticClass:"tc mb10"},[t._v(t._s(Number(t.gc)-e.mark)+"/"+t._s(e.should[0].number))]),t._v(" "),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:t.setGcP(e)}})],1):a("div",[a("div",{staticClass:"tc mb10"},[t._v(t._s(Number(t.dem)-e.mark)+"/"+t._s(e.should[0].number))]),t._v(" "),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:t.setDemP(e)}})],1)]):a("div",[a("div",{staticClass:"tc mb10"},[t._v("0/"+t._s(e.should[0].number))]),t._v(" "),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:0}})],1)])])]),t._v(" "),a("div",{staticClass:"clearfix wm_quest_bottom"},[a("div",{staticClass:"fl wm_quest_time"},[e.lock?a("span",[t._v("已接受，任务不会过期。")]):a("span",[t._v("过期:"+t._s(t._f("capitalize")(e.expired)))])]),t._v(" "),a("div",{staticClass:"fr"},[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return t.changeQuest(e._id)}}},[t._v(t._s(e.lock?"放弃":"更换"))]),e.lock?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.complete(e._id)}}},[t._v("完成")]):a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(a){return t.acceptQuest(e._id)}}},[t._v("接受")])],1)])])],1)}),1)],1),t._v(" "),a("div",{staticClass:"mb20"},[a("el-card",{attrs:{shadow:"hover"}},[t.shouldQuest>0?a("div",[a("div",{staticClass:"tc mb10"},[t._v("完成"+t._s(t.shouldQuest)+"次任务可以获得额外奖励哦！")]),t._v(" "),a("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:t.questProgress}})],1):a("div",[a("div",{staticClass:"tc mb10"},[t._v("领取任务奖励！")]),t._v(" "),a("el-button",{staticClass:"w_10",attrs:{type:"primary",size:"small",round:""},on:{click:t.treasure}},[t._v("领取奖励")])],1)])],1)],1),t._v(" "),a("menuView"),t._v(" "),a("cardInfoDialog",{attrs:{cardInfoDigShow:t.cardInfoShow,cardData:t.cardData},on:{cardInfoShow:t.cardInfoDiaShow,buyNewCard:t.updateMyCard,updateUserinfo:t.updateUserinfo}})],1)},m=[],_={render:l,staticRenderFns:m},v=_,p=a("VU/8"),g=s,b=p(u,v,!1,g,"data-v-466b348c",null);e.default=b.exports},WJNn:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"\n.wm_quest_title[data-v-466b348c]{\r\n  border-bottom: 1px solid #cecece;\n}\n.wm_quest_gift_ico[data-v-466b348c]{\r\n  padding: 5px;\r\n  border-radius: 5px;\r\n  border:1px solid #cecece;\r\n  height: 32px;\r\n  height: 32px;\n}\n.wm_quest_text[data-v-466b348c]{\r\n  padding: 15px 0;\r\n  border-top: 1px dashed #cecece;\n}\n.wm_quest_should_list[data-v-466b348c]{\r\n  min-height: 75px;\n}\n.wm_quest_should_card[data-v-466b348c]{\r\n  height: 55px;\r\n  width: auto;\n}\n.wm_quest_bottom[data-v-466b348c]{\r\n  border-top: 1px dashed #cecece;\r\n  padding-top: 15px;\r\n  margin-top: 15px;\n}\n.wm_quest_time[data-v-466b348c]{\r\n  font-size: 13px;\r\n  padding-top: 6px;\n}\n.list-complete-item[data-v-466b348c] {\r\n  -webkit-transition: all 1s;\r\n  transition: all 1s;\n}\n.list-complete-enter[data-v-466b348c], .list-complete-leave-to[data-v-466b348c]{\r\n  opacity: 0;\n}\n.list-complete-leave-active[data-v-466b348c] {\r\n  position: absolute;\r\n  bottom: 0;\r\n  right: 0;\n}\n.wm_quest_list_body[data-v-466b348c]{\r\n  position: relative;\r\n  z-index: 1;\n}\n.wm_quest_cardlist[data-v-466b348c]{\r\n  position: relative;\r\n  z-index: 1;\n}\n.wm_quest_battlecard[data-v-466b348c] {\r\n    position: absolute;\r\n    font-size: 12px;\r\n    line-height: 12px;\r\n    padding: 3px;\r\n    background: rgba(255, 76, 76, 0.75);\r\n    color: #fff;\r\n    top: 34px;\r\n    left: 2px;\r\n    z-index: 1;\r\n    border-radius: 3px;\n}\r\n",""])},ol3I:function(t,e,a){var s=a("WJNn");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("2971ba3b",s,!0,{})}});